import { useState, useCallback } from 'react';\nimport { MediaFile } from './useMediaLibrary';\n\nexport interface ImageSelectorOptions {\n  allowMultiple?: boolean;\n  filterByType?: 'image' | 'video' | 'document' | 'all';\n  maxSelection?: number;\n}\n\nexport function useImageSelector(options: ImageSelectorOptions = {}) {\n  const {\n    allowMultiple = false,\n    filterByType = 'image',\n    maxSelection = 1\n  } = options;\n\n  const [isOpen, setIsOpen] = useState(false);\n  const [selectedImages, setSelectedImages] = useState<MediaFile[]>([]);\n  const [onSelectionComplete, setOnSelectionComplete] = useState<((files: MediaFile[]) => void) | null>(null);\n\n  const openSelector = useCallback((callback?: (files: MediaFile[]) => void) => {\n    setSelectedImages([]);\n    setOnSelectionComplete(() => callback || null);\n    setIsOpen(true);\n  }, []);\n\n  const closeSelector = useCallback(() => {\n    setIsOpen(false);\n    setSelectedImages([]);\n    setOnSelectionComplete(null);\n  }, []);\n\n  const selectImage = useCallback((file: MediaFile) => {\n    if (!allowMultiple) {\n      setSelectedImages([file]);\n      return;\n    }\n\n    setSelectedImages(prev => {\n      const isAlreadySelected = prev.find(f => f.id === file.id);\n      \n      if (isAlreadySelected) {\n        return prev.filter(f => f.id !== file.id);\n      }\n\n      if (prev.length >= maxSelection) {\n        return prev;\n      }\n\n      return [...prev, file];\n    });\n  }, [allowMultiple, maxSelection]);\n\n  const confirmSelection = useCallback(() => {\n    if (onSelectionComplete && selectedImages.length > 0) {\n      onSelectionComplete(selectedImages);\n    }\n    closeSelector();\n  }, [selectedImages, onSelectionComplete, closeSelector]);\n\n  const filterFiles = useCallback((files: MediaFile[]) => {\n    if (filterByType === 'all') {\n      return files;\n    }\n    return files.filter(file => file.type === filterByType);\n  }, [filterByType]);\n\n  return {\n    // Estado\n    isOpen,\n    selectedImages,\n    canConfirm: selectedImages.length > 0,\n    \n    // Acciones\n    openSelector,\n    closeSelector,\n    selectImage,\n    confirmSelection,\n    filterFiles,\n    \n    // Configuraci√≥n\n    allowMultiple,\n    maxSelection,\n    filterByType,\n  };\n}\n\nexport default useImageSelector;"