# Sistema de Live Preview - Documentaci√≥n Completa\n\n## üöÄ Introducci√≥n\n\nEl Sistema de Live Preview es una implementaci√≥n completamente reconstruida que permite a los editores previsualizar cambios en tiempo real en diferentes tipos de dispositivos. Esta soluci√≥n proporciona una experiencia de edici√≥n fluida y profesional.\n\n## üéØ Caracter√≠sticas Principales\n\n### ‚ú® Funcionalidades Core\n\n- **Vista Multi-Dispositivo**: Simulaci√≥n precisa de m√≥vil, tablet y desktop\n- **Preview en Tiempo Real**: Actualizaci√≥n autom√°tica de cambios\n- **Navegaci√≥n Personalizada**: Cambio de URLs dentro del preview\n- **Modo Pantalla Completa**: Vista inmersiva sin distracciones\n- **Atajos de Teclado**: Control r√°pido y eficiente\n- **Indicadores Visuales**: Estado de carga y dispositivo actual\n\n### üé® Mejoras de UI/UX\n\n- **Marcos de Dispositivo Realistas**: Simulaci√≥n visual de diferentes dispositivos\n- **Transiciones Suaves**: Animaciones fluidas entre estados\n- **Feedback Visual**: Indicadores de carga y estado\n- **Responsive Design**: Adaptable a diferentes tama√±os de pantalla\n- **Accesibilidad**: Soporte completo para lectores de pantalla\n\n## üèóÔ∏è Arquitectura\n\n### Componentes Principales\n\n```\nüìÅ components/Admin/\n‚îú‚îÄ‚îÄ üé≠ LivePreview.tsx          # Componente principal del preview\n‚îú‚îÄ‚îÄ üé® LivePreview.css          # Estilos personalizados\n‚îî‚îÄ‚îÄ üìã LivePreviewDemo.tsx      # Componente de demostraci√≥n\n\nüìÅ hooks/\n‚îî‚îÄ‚îÄ üé™ useLivePreview.ts        # Hook personalizado para gesti√≥n de estado\n\nüìÅ contexts/\n‚îú‚îÄ‚îÄ üë§ AdminContext.tsx         # Contexto de administraci√≥n\n‚îî‚îÄ‚îÄ üè† HomeDataContext.tsx      # Contexto de datos de la p√°gina\n\nüìÅ pages/admin/\n‚îî‚îÄ‚îÄ ‚úèÔ∏è HomeEditor.tsx           # Editor principal integrado\n```\n\n### Flujo de Datos\n\n```mermaid\ngraph TD\n    A[AdminContext] --> B[HomeEditor]\n    B --> C[LivePreview]\n    C --> D[iframe Preview]\n    E[useLivePreview Hook] --> C\n    F[HomeDataContext] --> B\n    G[PendingChanges] --> F\n```\n\n## üîß Configuraci√≥n de Dispositivos\n\n```typescript\nconst DEVICE_CONFIGS = {\n  mobile: {\n    width: 375,\n    height: 812,\n    name: \"iPhone 13\",\n    scale: 1,\n    showStatusBar: true\n  },\n  tablet: {\n    width: 768,\n    height: 1024,\n    name: \"iPad\",\n    scale: 0.85,\n    showStatusBar: false\n  },\n  desktop: {\n    width: 1440,\n    height: 900,\n    name: \"Desktop\",\n    scale: 0.7,\n    showStatusBar: false\n  }\n};\n```\n\n## ‚å®Ô∏è Atajos de Teclado\n\n| Atajo | Funci√≥n |\n|-------|----------|\n| `ESC` | Cerrar preview |\n| `F5` | Actualizar contenido |\n| `Ctrl + R` | Actualizar contenido |\n| `Ctrl + 1` | Cambiar a vista m√≥vil |\n| `Ctrl + 2` | Cambiar a vista tablet |\n| `Ctrl + 3` | Cambiar a vista desktop |\n| `Ctrl + Enter` | Abrir en nueva pesta√±a |\n\n## üéÆ Uso del Sistema\n\n### Integraci√≥n B√°sica\n\n```tsx\nimport { useAdmin } from '@/contexts/AdminContext';\nimport LivePreview from '@/components/Admin/LivePreview';\n\nfunction MyEditor() {\n  const { \n    isPreviewMode, \n    setIsPreviewMode,\n    previewDevice,\n    setPreviewDevice \n  } = useAdmin();\n\n  return (\n    <>\n      {/* Bot√≥n para activar preview */}\n      <button onClick={() => setIsPreviewMode(true)}>\n        Vista Previa\n      </button>\n\n      {/* Componente Live Preview */}\n      <LivePreview\n        isOpen={isPreviewMode}\n        device={previewDevice}\n        onClose={() => setIsPreviewMode(false)}\n        onDeviceChange={setPreviewDevice}\n      />\n    </>\n  );\n}\n```\n\n### Uso del Hook Personalizado\n\n```tsx\nimport useLivePreview from '@/hooks/useLivePreview';\n\nfunction AdvancedEditor() {\n  const preview = useLivePreview({\n    device: 'mobile',\n    currentUrl: '/admin'\n  });\n\n  return (\n    <div>\n      <button onClick={() => preview.actions.openPreview('tablet', '/about')}>\n        Preview Tablet - About Page\n      </button>\n      \n      <LivePreview\n        isOpen={preview.isOpen}\n        device={preview.device}\n        onClose={preview.actions.closePreview}\n        onDeviceChange={preview.actions.changeDevice}\n      />\n    </div>\n  );\n}\n```\n\n## üé® Personalizaci√≥n de Estilos\n\n### Clases CSS Disponibles\n\n- `.live-preview-container` - Contenedor principal\n- `.device-selector` - Selector de dispositivos\n- `.preview-controls` - Barra de controles\n- `.device-frame` - Marco del dispositivo\n- `.mobile-preview-container` - Estilo espec√≠fico m√≥vil\n- `.tablet-preview-container` - Estilo espec√≠fico tablet\n- `.desktop-preview-container` - Estilo espec√≠fico desktop\n- `.keyboard-shortcuts` - Tooltip de atajos\n\n### Personalizaci√≥n de Marcos\n\n```css\n.mobile-preview-container {\n  background: linear-gradient(45deg, #667eea 0%, #764ba2 100%);\n  border-radius: 25px;\n  padding: 8px;\n  box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.4);\n}\n```\n\n## üîÑ Gesti√≥n de Estado\n\n### AdminContext\n\nEl contexto de administraci√≥n gestiona:\n\n- `isPreviewMode`: Estado del modo preview\n- `previewDevice`: Dispositivo actual\n- `pendingChanges`: Cambios pendientes de publicaci√≥n\n- `hasUnsavedChanges`: Indicador de cambios no guardados\n\n### HomeDataContext\n\nEl contexto de datos gestiona:\n\n- `sections`: Secciones de la p√°gina\n- `sliders`: Elementos del slider\n- `refreshTrigger`: Trigger para actualizaci√≥n\n- `applyPendingChanges`: Aplicaci√≥n de cambios en tiempo real\n\n## üõ†Ô∏è Soluci√≥n de Problemas\n\n### Problemas Comunes\n\n1. **Preview no se actualiza**\n   - Verificar que el contexto HomeDataContext est√© disponible\n   - Comprobar que `triggerRefresh` se est√° llamando correctamente\n\n2. **Errores de iframe**\n   - Verificar pol√≠ticas de CORS\n   - Comprobar que la URL es accesible\n\n3. **Estilos no se aplican**\n   - Verificar que LivePreview.css est√° siendo importado\n   - Comprobar orden de importaci√≥n de CSS\n\n### Debug Mode\n\n```typescript\n// Activar logs detallados\nconst DEBUG_PREVIEW = true;\n\nif (DEBUG_PREVIEW) {\n  console.log('Preview state:', { isOpen, device, currentUrl });\n}\n```\n\n## üöÄ Mejoras Futuras\n\n### Roadmap\n\n- [ ] **Vista Split**: Preview lado a lado con editor\n- [ ] **Grabaci√≥n de Interacciones**: Captura de flujo de usuario\n- [ ] **Comparaci√≥n Visual**: Antes/despu√©s de cambios\n- [ ] **Preview Colaborativo**: Compartir preview en tiempo real\n- [ ] **Dispositivos Personalizados**: Configuraci√≥n de resoluciones custom\n- [ ] **Modo Oscuro**: Soporte para tema oscuro\n\n### Optimizaciones\n\n- [ ] **Lazy Loading**: Carga diferida de componentes\n- [ ] **Cache Inteligente**: Cache de iframes por dispositivo\n- [ ] **Compresi√≥n de Im√°genes**: Optimizaci√≥n autom√°tica\n- [ ] **Service Worker**: Cache offline\n\n## üìù Changelog\n\n### v2.0.0 - Reconstrucci√≥n Completa\n\n**üéâ Nuevas Caracter√≠sticas:**\n- Sistema completamente reconstruido desde cero\n- Soporte para m√∫ltiples dispositivos con simulaci√≥n realista\n- Atajos de teclado avanzados\n- Hook personalizado `useLivePreview`\n- Estilos CSS personalizados con animaciones\n- Modo pantalla completa\n- Tooltip de ayuda interactivo\n\n**üîß Mejoras T√©cnicas:**\n- Arquitectura modular y extensible\n- Mejor gesti√≥n de estado\n- Optimizaci√≥n de rendimiento\n- Accesibilidad mejorada\n- TypeScript completo\n\n**üêõ Correcciones:**\n- Problemas de sincronizaci√≥n entre editor y preview\n- Errores de carga de iframe\n- Conflictos de estilos\n- Memory leaks en listeners de eventos\n\n## üìö Referencias\n\n- [React Hooks Documentation](https://reactjs.org/docs/hooks-intro.html)\n- [TypeScript Handbook](https://www.typescriptlang.org/docs/)\n- [Tailwind CSS](https://tailwindcss.com/docs)\n- [Lucide Icons](https://lucide.dev/)\n\n---\n\n**Desarrollado con ‚ù§Ô∏è para Bionutrex**\n\n*Sistema de Live Preview v2.0 - Enero 2025*"